## Инструменты для разработки

В прошлой главе мы вводили Bash-команды через эмулятор терминала. При этом набранный текст сохранялся в памяти эмулятора. Физически она находится в оперативной памяти компьютера. RAM — это место для временного хранения информации. После выключения компьютера, она очищается.

Из-за временного характера RAM-памяти терминала будет недостаточно для разработки программ. Вам понадобится удобный [редактор](https://ru.wikipedia.org/wiki/Редактор_исходного_кода). С ним вы сможете создавать файлы с исходным кодом и сохранять их на жёстком диске. Жёсткий диск в отличие от RAM предназначен для долгосрочного хранения информации.

### Редактор исходного кода

Писать Bash-скрипты можно в любом текстовом редакторе. Подойдёт даже стандартное приложение Windows — [Блокнот](https://ru.wikipedia.org/wiki/Блокнот_(программа)) (Notepad). Но работать с ним будет неудобно. У Блокнота нет дополнительных возможностей для редактирования исходного кода. Эти возможности увеличат вашу продуктивность. Попробуйте несколько специальных редакторов и выберите из них понравившийся.

Мы рассмотрим три популярных редактора исходного кода. На самом деле их намного больше. Если ни один из трёх вам не подошёл, поищите альтернативы в интернете.

W> Обратите внимание, что офисный пакет MS Office и его открытый аналог [LibreOffice](https://ru.wikipedia.org/wiki/LibreOffice) не подходят для написания кода. Они сохраняют файлы в бинарных или [XML-подобных](https://ru.wikipedia.org/wiki/XML) форматах. Интерпретаторы и компиляторы не смогут их прочитать. Им нужны текстовые файлы. Именно в таком формате сохраняют файлы редакторы исходного кода.

[**Notepad++**](https://ru.wikipedia.org/wiki/Notepad++#cite_note-8) — это быстрый и минималистичный свободный редактор с открытым исходным кодом. Он запускается только на ОС Windows. Поэтому для macOS или Linux, лучше рассмотреть другие варианты. Последнюю версию Notepad++ можно загрузить с [официального сайта](https://notepad-plus-plus.org/downloads/).

[**Sublime Text**](https://ru.wikipedia.org/wiki/Sublime_Text#cite_note-Features-4) — проприетарный [**кроссплатформенный**](https://ru.wikipedia.org/wiki/Кроссплатформенность) редактор. Кроссплатформенность означает, что программа запускается на разных ОС и [**аппаратных платформах**](https://ru.wikipedia.org/wiki/Аппаратная_платформа_компьютера). Sublime Text можно использовать бесплатно без активации и лицензии. Но в этом режиме редактор регулярно выводит диалоговое окно с предложением купить лицензию. Загрузить программу можно c [официального сайта](https://www.sublimetext.com/).

[*Visual Studio Code*](https://ru.wikipedia.org/wiki/Visual_Studio_Code) — свободный кроссплатформенный редактор от компании Microsoft. Его исходный код открыт. Это означает, что программа доступна бесплатно и без лицензии. Редактор можно загрузить с [официального сайта](https://code.visualstudio.com/).

Для работы с исходным кодом у всех трёх редакторов есть следующие возможности:

* [Подсветка синтаксиса](https://ru.wikipedia.org/wiki/Подсветка_синтаксиса).
* [Автодополнение](https://ru.wikipedia.org/wiki/Автодополнение).
* Поддержка и конвертирование широко распространённых [кодировок](https://ru.wikipedia.org/wiki/Набор_символов).

Редактировать исходный код можно и без этих возможностей. Но они ускоряют работу, облегчают редактирование программы и поиск в ней ошибок. Кроме того они помогут вам быстрее освоится с синтаксисом Bash.

### Запуск редактора из Bash

Как и другие программы редактор исходного кода запускается через графический интерфейс ОС. Например, в случае Windows — через меню Пуск или иконку на рабочем столе. Кроме этого редактор можно запустить через интерфейс командной строки. Так удобнее редактировать файлы, имена которых вернула какая-то Bash-команда или утилита.

В прошлой главе мы запускали приложения тремя способами:

1. По абсолютному пути.
2. По относительному пути.
3. По имени исполняемого файла.

Для последнего способа каталог установки программы должен быть в переменной `PATH`. 

В качестве примера запустим редактор Notepad++ из командной строки.

По умолчанию путь установки редактора следующий:
{line-numbers: false}
```
C:\Program Files (86)\Notepad++
```

I> Если вы не знаете путь установки, прочитайте его в свойствах ярлыка Notepad++ на рабочем столе или в меню Пуск.

В Unix-окружении тот же путь установки выглядит так:
{line-numbers: false}
```
/c/Program Files (x86)/Notepad++
```

Если запустить Notepad++ по этому абсолютному пути, будет выведено сообщение об ошибке как на иллюстрации 3-1.

{caption: "Иллюстрация 3-1. Результат запуска Notepad++"}
![Результат запуска Notepad++](images/BashScripting/notepad-error.png)

В чём ошибка? На самом деле в этой команде несколько проблем. Рассмотрим их по порядку. Для начала попробуем выполнить следующую команду cd:
{line-numbers: false, format: Bash}
```
cd /c/Program Files
```

Её результат на иллюстрации 3-2.

{caption: "Иллюстрация 3-2. Результат выполнения cd"}
![Результат cd](images/BashScripting/cd-many-arguments.png)

Bash пишет: в команду было передано больше параметров, чем нужно. Команда cd принимает на вход один путь к целевому каталогу. Ошибка возникла из-за word splitting. Bash интерпретирует пробел не как часть пути, а как разделитель между двумя параметрами. Таким образом в команду cd передаются два пути: `/c/Program` и `Files`.

Подобные ошибки решаются двумя способами:

1. Заключить путь в двойные кавычки:
{line-numbers: false, format: Bash}
```
cd "/c/Program Files"
```

2. Экранировать все пробелы с помощью обратного слэша:
{line-numbers: false, format: Bash}
```
cd /c/Program\ Files
```

Каждая из этих команд выполнится корректно.

Теперь попробуем перейти по пути `/c/Program Files (x86)`:
{line-numbers: false, format: Bash}
```
cd /c/Program Files (x86)
```

Как мы выяснили, Bash обрабатывает пробелы по своему усмотрению. Поэтом экранируем их с помощью обратного слэша. Получим следующую команду:
{line-numbers: false, format: Bash}
```
cd /c/Program\ Files\ (x86)
```

Эта команда всё равно завершится с ошибкой, как на иллюстрации 3-3.

{caption: "Иллюстрация 3-3. Результат выполнения cd"}
![Результат cd](images/BashScripting/cd-unexpected-token.png)

При запуске Notepad++ выводилось такое же сообщение об ошибке (см. иллюстрацию 3-1). Проблема в том, что кавычки ( и ) являются частью синтаксиса Bash. Поэтому интерпретатор пытается обработать их как конструкцию языка. Мы уже сталкивались с этой проблемой, когда группировали выражения утилиты find. Экранирование или двойные кавычки решат проблему. Например:
{line-numbers: true, format: Bash}
```
cd /c/Program\ Files\ \(x86\)
cd "/c/Program Files (x86)"
```

Применив кавычки, мы получим такую команду запуска Notepad++ по абсолютному пути:
{line-numbers: false, format: Bash}
```
"/c/Program Files (x86)/Notepad++/notepad++.exe"
```

Каждый раз набирать полный путь установки редактора неудобно. Намного лучше было бы запускать его по имени исполняемого файла. Чтобы этот способ заработал, добавьте путь установки Notepad++ в переменную `PATH`. Для этого в конец файла `~/.bash_profile` добавьте следующую строку:
{line-numbers: false, format: Bash}
```
PATH="/c/Program Files (x86)/Notepad++:${PATH}"
```

Закройте и снова откройте терминал MSYS2. Теперь Notepad++ запускается следующей командой:
{line-numbers: false, format: Bash}
```
notepad++.exe
```

Вместо редактирования переменной `PATH` можно использовать псевдонимом (alias). Этот механизм заменяет введённую команду на другую. Таким образом в окне терминала можно сократить набор длинных строк.

Объявим псевдоним `notepad++` для следующей команды:
{line-numbers: false, format: Bash}
```
"/c/Program Files (x86)/Notepad++/notepad++.exe"
```

Для этого выполните такую команду alias:
{line-numbers: false, format: Bash}
```
alias notepad++="/c/Program\ Files\ \(x86\)/Notepad++/notepad++.exe"
```

Теперь встретив команду `notepad++`, Bash будет запускать редактор по указанному нами абсолютному пути. У этого решения есть одна проблема: псевдоним придётся объявлять каждый раз после перезапуска терминала MSYS2. Чтобы это происходило автоматически, добавьте команду alias в файл `~/.bashrc`. Bash исполняет этот файл перед каждым запуском терминала.

После интеграции Notepad++ в Bash, файлы в редакторе открываются из командной строки. Для этого передайте имя файла первым параметром программе notepad++. Например:
{line-numbers: false, format: Bash}
```
notepad++ test.txt
```

Если файла `test.txt` не существует, откроется диалог с предложением его создать.

Допустим, вы запустили графическое приложение в окне терминала. После этого в терминал нельзя вводить команды. Его контролирует запущенное приложение. Так оно выводит на экран свои диагностические сообщения. Только после завершения программы, терминал заработает в обычном режиме.

Чтобы продолжить работу с терминалом, запускайте графические приложения в **фоновом режиме** (background). Для этого добавьте амперсанд & в конце команды. Например:
{line-numbers: false, format: Bash}
```
notepad++ test.txt &
```

В результате приложение по-прежнему будет выводить сообщения в окно терминала, но при этом вы сможете вводить Bash-команды. Чтобы полностью разделить окно терминал и запущенное приложение, выполните команду disown с опцией `-a`:
{line-numbers: false, format: Bash}
```
disown -a
```

В результате вывод сообщений в окно терминала прекратится. После закрытия этого окна, приложение продолжит свою работу.

Команды запуска Notepad++ и disown можно объединить в одну. Например, так:
{line-numbers: false, format: Bash}
```
notepad++ test.txt & disown -a
```

Параметр `-a` команды disown отделяет все приложения запущенные в фоновом режиме.

Переменная окружения Bash `$!` хранит идентификатор [PID](https://ru.wikipedia.org/wiki/Идентификатор_процесса) последнего запущенного приложения. С её помощью в команду disown можно передать только PID редактора. В этом случае команда запуска Notepad++ будет выглядеть так:
{line-numbers: false, format: Bash}
```
notepad++ test.txt & disown $!
```

Чтобы вывести список всех приложений, запущенных в фоновом режиме, наберите команду jobs с опцией `-l`:
{line-numbers: false, format: Bash}
```
jobs -l
```

Так вы узнаете их идентификаторы PID.